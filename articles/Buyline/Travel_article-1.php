<?php
include __DIR__ . '/../../header.php';
?>

    <div class="max-w-6xl mx-auto px-4 py-8">
        <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
            <!-- Article main column -->
            <main class="relative md:col-span-9 bg-white rounded shadow p-6">
                <div class="mb-4">
                    <img src="/assets/Buyline_assets/Travel_SPic-5.avif" alt="Martini article hero" class="w-full rounded-lg object-cover" style="height:360px;" />
                    
                </div>

                <h1 class="text-3xl font-bold text-blue-800 mb-2">
                    London's 25 best martinis revealed: After five years of research (and hundreds of drinks!), HUGHIE DE ZULUETA and ELLA MAY share their must-read guide
                </h1>

                <div class="my-4 border-t border-b border-blue-300 py-2">
                    <div class="text-xl text-gray-600 mb-2 byline">By HUGHIE DE ZULUETA and ELLA MAY</div>
                    <div class="text-xl text-gray-600 mb-0 byline">Published: 01:03 GMT, 6 December 2025 | Updated: 10:21 GMT, 8 December 2025</div>
                </div>

                <p class="text-gray-700 leading-relaxed">
                    Five years ago, my girlfriend and I set out to find the best martini in London. We were intent on locating a place where even the martini’s greatest ambassador, James Bond, would enjoy drinking his favourite drink. And now, finally, we can reveal the definitive bars for a martini worthy of 007 himself.
                </p>

                <p class="text-gray-700 leading-relaxed">
                    At first, it felt like an almost impossible task. There’s an incalculable number of bars in the capital and almost endless martini combinations. Gin or vodka? Lemon or olive? Wet, dry, extra dry, or bone dry? And then what about more maverick varieties: the Gibson, the Montgomery, Martinez, Lychee, Appletini and the risque-sounding Porn Star?
                </p>

                <p class="text-gray-700 leading-relaxed">
                    While the drink’s origin is unclear, what’s certain is that Ian Fleming’s spy popularised the martini. In all Fleming’s books, Bond consumes a total of 35 martinis, with Sean Connery the first to deliver the famous line - ‘shaken, not stirred’ - on screen in Goldfinger (1964).
                </p>

                <p class="text-gray-700 leading-relaxed">
                    Being 007’s home city, London made sense for our mission - and we stuck to hotel bars as Bond rarely drinks anywhere else. As a strict rule, I only ordered martinis the way he liked them (‘dry vodka martini with a lemon twist’), while my girlfriend, to spice things up, ordered dirty martinis.
                </p>

                <p class="text-gray-700 leading-relaxed">
                    It’s seemingly fashionable, once again, to be a martini drinker. However, this trend has spawned a growing number of ‘martini-pseuds’, a wave of ‘connaisseurs’ who describe their tipples with oblivious, bombastic pretension as anything from ‘vessels of temptation’ to ‘silken glaciers’ or ‘barfly bewitchers’.
                </p>

                <p class="text-gray-700 leading-relaxed">
                    Then there are those, with a small amount of knowledge, who will ask: ‘Have you tried The Connaught bar?’ or ‘What about Duke’s Hotel?’ And yes, both establishments are on this list, but neither makes our top ten (and both, frankly, felt like tourist traps).
                </p>

                <p class="text-gray-700 leading-relaxed">
                    This project was ruinously expensive. Martinis in London typically start at £20 - and once you get a couple of rounds and some (absurdly expensive) bar snacks, bills regularly top £100. The most expensive martini, for the record, was at The Connaught Bar (£30), while the most ‘reasonable’ at the Side Hustle bar at The Nomad (£18).
                </p>

                <p class="text-gray-700 leading-relaxed">
                    I’d often look at our ornate, lengthening spreadsheet and wonder whether the task justified the debt. But that, I think, was actually the point. In an age where everyone is posting, tracking and achieving, we had done the opposite. We had gone out, night after night, and got quietly, yet stylishly, incapacitated - and, in doing so, found something close to pure happiness.
                </p>

                <h2 class="text-2xl font-semibold text-blue-800 mt-6 mb-2">How we scored each bar...</h2>
                <p class="text-gray-700 leading-relaxed">
                    We developed a scoring system across five measures. The first was the requirement for a balanced, ice-cold, near-neat ethanol hit. Secondly, the glass should sit nicely in the hand. The third point of order was the need for flawless, friendly service. Fourth up, we were seeking a feel-good atmosphere, whatever that may be. Finally, we sought finger-licking bar snacks. All these considerations combined - at a heightened level - and you’ll have the perfect martini experience.
                </p>

                <section class="mt-6">
                    <div class="mt-4">
                        <img src="/assets/Buyline_assets/Travel_SPic-1.avif" alt="Furbo Mini 360° close-up" class="w-full h-auto object-contain rounded-lg shadow" />
                    </div>
                    <p class="text-gray-700 mt-2">Other perks of the I-Master Air Fryer Series 5 is that it boasts a spacious seven-litre capacity, so it’s large enough to cook for a family of four or roast a whole chicken, yet it's compact enough to fit neatly on your countertop.
                        And according to the brand description, the energy-saving design cuts energy usage by up to 70 per cent compared to traditional ovens, while air frying uses up to 90 per cent less fat. 
                        <br>Helping you whip up quick nibbles for guests over the Christmas period or just spend less time in the kitchen when there's so much else to do, this Haier air fryer is perfect for busy families or those who prefer a sleeker-looking kitchen appliance.
                    </p>

                </section>                

                <div class="my-4 border-t border-blue-300 py-2">

                    <!-- Places -->
                    <div class="flex gap-4 my-6 p-4 border rounded-lg bg-white">
                        <img src="/assets/Buyline_assets/Travel_SPic-2.avif" alt="Furbo 360 Dog Camera" class="w-32" style="width: 300px">
                        <div>
                            <h3 class="text-xl font-bold">THE EGERTON, Knightsbridge: The Bar  </h3>
                    
                            <p class="text-lg font-bold mt-3">Details: egertonhousehotel.com </p>
                            <button class="bg-orange-500 text-white px-4 py-2 rounded mt-2">Book</button>
                        </div>
                    </div>

                    <!-- Places -->
                    <div class="flex gap-4 my-6 p-4 border rounded-lg bg-white">
                        <img src="/assets/Buyline_assets/Travel_SPic-3.avif" alt="Furbo 360 Dog Camera" class="w-32" style="width: 300px">
                        <div>
                            <h3 class="text-xl font-bold"> THE STANDARD, King’s Cross: Decimo Bar   </h3>
                    
                            <p class="text-lg font-bold mt-3">Details: standardhotels.com  </p>
                            <button class="bg-orange-500 text-white px-4 py-2 rounded mt-2">Book</button>
                        </div>
                    </div>

                    <!-- Places -->
                    <div class="flex gap-4 my-6 p-4 border rounded-lg bg-white">
                        <img src="/assets/Buyline_assets/Travel_SPic-4.avif" alt="Furbo 360 Dog Camera" class="w-32" style="width: 300px">
                        <div>
                            <h3 class="text-xl font-bold"> DUKES, St. James’s: Duke’s Bar  </h3>
                    
                            <p class="text-lg font-bold mt-3">Details: dukeshotel.com  </p>
                            <button class="bg-orange-500 text-white px-4 py-2 rounded mt-2">Book</button>
                        </div>
                    </div>                    
                    
                </div>


                <?php
                // Sample comments (server-side placeholders). These are intentionally
                // small and client-side 'Show more' will append additional dummy
                // comments. Replies and votes are client-only and not persisted.
                $comments = [
                    [
                        'name' => 'James',
                        'location' => 'London, United Kingdom',
                        'time' => 'Just now',
                        'text' => "Loved this guide! Now I know exactly which bars to try for a proper martini. A must-read for Bond fans.",
                        'up' => 0,
                        'down' => 0,
                    ],
                    [
                        'name' => 'Sophia',
                        'location' => 'Manchester, United Kingdom',
                        'time' => '5 minutes ago',
                        'text' => "Fantastic article! The scoring system makes it easy to see which bars really stand out. Excited to visit them all!",
                        'up' => 0,
                        'down' => 0,
                    ],
                    [
                        'name' => 'Liam',
                        'location' => 'Birmingham, United Kingdom',
                        'time' => '10 minutes ago',
                        'text' => "This is gold for martini lovers. I appreciate the detail and the fun storytelling behind each bar visit.",
                        'up' => 0,
                        'down' => 0,
                    ],
                ];

                $comment_count = 52; // total count for the 'Show more' button
                ?>


                <section id="comments-section" class="mt-6 bg-white rounded shadow p-4">
                    <div class="flex items-start justify-between">
                        <h3 class="text-lg font-semibold">Comments (<?php echo $comment_count; ?>)</h3>
                        <div class="text-sm text-gray-600"> <a href="/login.php" class="text-blue-600 hover:underline">Log in</a> </div>
                    </div>

                    <div class="mt-4 flex gap-4 items-start">
                        <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-500"> 
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                        </div>
                        <textarea placeholder="Enter your comment..." class="flex-1 border rounded p-3 text-sm resize-none h-12"></textarea>
                        <a href="/login.php" class="ml-4 bg-blue-600 text-white px-4 py-2 rounded-full inline-flex items-center justify-center">Log in to comment</a>
                    </div>

                    <div class="mt-4 text-sm text-gray-600">Comments are subject to our <a href="#" class="text-blue-600 underline">House rules</a> and <a href="#" class="text-blue-600 underline">Terms</a></div>

                    <!-- Comments list -->
                    <div id="comments-list" class="mt-4 space-y-4">
                        <?php foreach($comments as $c): ?>
                            <div class="border-t pt-4">
                                <div class="flex gap-3">
                                    <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-sm text-gray-600"><?php echo strtoupper($c['name'][0]); ?></div>
                                    <div class="flex-1">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <div class="text-sm font-semibold"><?php echo htmlspecialchars($c['name']); ?></div>
                                                <div class="text-xs text-gray-500"><?php echo htmlspecialchars($c['location']); ?>, <?php echo $c['time']; ?></div>
                                            </div>
                                            <div class="text-xs text-gray-400"> 
                                                <button type="button" class="px-2 reply-link">Reply</button>
                                            </div>
                                        </div>
                                        <div class="mt-2 text-gray-800"><?php echo htmlspecialchars($c['text']); ?></div>
                                        <div class="mt-2 flex items-center gap-3 text-xs text-gray-500">
                                            <div>Click to rate</div>
                                            <div class="flex items-center gap-2">
                                                <button type="button" class="vote-btn vote-up text-green-600 border rounded-full w-6 h-6 flex items-center justify-center" data-vote="up" aria-label="Upvote">▲</button>
                                                <span class="vote-count-up text-green-600"><?php echo $c['up']; ?></span>
                                                <button type="button" class="vote-btn vote-down text-red-500 border rounded-full w-6 h-6 flex items-center justify-center" data-vote="down" aria-label="Downvote">▼</button>
                                                <span class="vote-count-down text-red-500"><?php echo $c['down']; ?></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <?php endforeach; ?>
                    </div>

                    <div class="mt-4 text-center">
                        <button id="show-more-comments" data-remaining="<?php echo ($comment_count - count($comments)); ?>" class="bg-blue-700 text-white px-6 py-2 rounded-full">Show <?php echo ($comment_count - count($comments)); ?> More Comments</button>
                    </div>
                </section>
                <style>
                /*Vote button animation styles*/
                .vote-btn { transition: transform .12s ease, background-color .18s ease; cursor: pointer; }
                .vote-btn.pop { transform: scale(1.15); }
                .vote-btn.active.vote-up { background-color: rgba(16,185,129,0.12); }
                .vote-btn.active.vote-down { background-color: rgba(239,68,68,0.12); }
                .vote-count-up, .vote-count-down { transition: transform .12s ease, color .12s ease; display:inline-block; min-width:18px; text-align:center; }
                .vote-count-up.pop, .vote-count-down.pop { transform: translateY(-4px) scale(1.05); }
                /* Reply styling + animation for newly added replies */
                .reply-new { background-color: #fff9ec; border-left: 3px solid #f59e0b; padding: 0.5rem; border-radius: 0.375rem; }
                .reply-animate { opacity: 0; transform: translateY(8px); transition: opacity .28s ease, transform .28s ease; }
                .reply-enter { opacity: 1; transform: translateY(0); }
                .reply-textarea { min-height: 64px; }
                </style>

                <script>
                (function(){
                    document.addEventListener('DOMContentLoaded', function(){
                        const commentsEl = document.getElementById('comments-section');
                        if (!commentsEl) return;

                        commentsEl.addEventListener('click', function(e){
                            const btn = e.target.closest('.vote-btn');
                            if (!btn) return;
                            e.preventDefault();

                            const vote = btn.dataset.vote; // 'up' or 'down'
                            const wrapper = btn.closest('.border-t');
                            if (!wrapper) return;
                            const upSpan = wrapper.querySelector('.vote-count-up');
                            const downSpan = wrapper.querySelector('.vote-count-down');

                            //Parse current counts
                            let up = parseInt(upSpan?.textContent || '0', 10) || 0;
                            let down = parseInt(downSpan?.textContent || '0', 10) || 0;

                            const isActive = btn.classList.contains('active');

                            //brief pop animation
                            btn.classList.add('pop');
                            setTimeout(() => btn.classList.remove('pop'), 180);

                            if (vote === 'up') {
                                if (isActive) {
                                    //undo upvote
                                    btn.classList.remove('active');
                                    up = Math.max(0, up - 1);
                                    if (upSpan) upSpan.textContent = up;
                                } else {
                                    //add upvote
                                    btn.classList.add('active');
                                    up = up + 1;
                                    if (upSpan) upSpan.textContent = up;
                                    //if down was active, remove it
                                    const other = wrapper.querySelector('[data-vote="down"]');
                                    if (other && other.classList.contains('active')) {
                                        other.classList.remove('active');
                                        down = Math.max(0, down - 1);
                                        if (downSpan) downSpan.textContent = down;
                                    }
                                }
                            } else if (vote === 'down') {
                                if (isActive) {
                                    btn.classList.remove('active');
                                    down = Math.max(0, down - 1);
                                    if (downSpan) downSpan.textContent = down;
                                } else {
                                    btn.classList.add('active');
                                    down = down + 1;
                                    if (downSpan) downSpan.textContent = down;
                                    const other = wrapper.querySelector('[data-vote="up"]');
                                    if (other && other.classList.contains('active')) {
                                        other.classList.remove('active');
                                        up = Math.max(0, up - 1);
                                        if (upSpan) upSpan.textContent = up;
                                    }
                                }
                            }

                            //animate counts
                            if (upSpan) { upSpan.classList.add('pop'); setTimeout(()=> upSpan.classList.remove('pop'),180); }
                            if (downSpan) { downSpan.classList.add('pop'); setTimeout(()=> downSpan.classList.remove('pop'),180); }
                        });

                        //Show more comments logic (client-side only)
                        const showBtn = document.getElementById('show-more-comments');
                        const commentsList = document.getElementById('comments-list');
                        if (showBtn && commentsList) {
                            let remaining = parseInt(showBtn.dataset.remaining || '0', 10) || 0;
                            const batch = 5; //number of comments to append per click

                            //helper to create a comment element
                            function createComment(i) {
                                const wrapper = document.createElement('div');
                                wrapper.className = 'border-t pt-4';
                                const initials = String.fromCharCode(65 + (i % 26));
                                wrapper.innerHTML = `
                                    <div class="flex gap-3">
                                        <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-sm text-gray-600">${initials}</div>
                                        <div class="flex-1">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <div class="text-sm font-semibold">Commenter ${i}</div>
                                                    <div class="text-xs text-gray-500">Somewhere, United Kingdom, just now</div>
                                                </div>
                                                <div class="text-xs text-gray-400"><button type="button" class="px-2 reply-link">Reply</button></div>
                                            </div>
                                            <div class="mt-2 text-gray-800">This is a sample additional comment number ${i} appended by the "Show more" button.</div>
                                            <div class="mt-2 flex items-center gap-3 text-xs text-gray-500">
                                                <div>Click to rate</div>
                                                <div class="flex items-center gap-2">
                                                    <button type="button" class="vote-btn vote-up text-green-600 border rounded-full w-6 h-6 flex items-center justify-center" data-vote="up">▲</button>
                                                    <span class="vote-count-up text-green-600">0</span>
                                                    <button type="button" class="vote-btn vote-down text-red-500 border rounded-full w-6 h-6 flex items-center justify-center" data-vote="down">▼</button>
                                                    <span class="vote-count-down text-red-500">0</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>`;
                                //start hidden for animation
                                wrapper.style.opacity = '0';
                                wrapper.style.transform = 'translateY(8px)';
                                wrapper.style.transition = 'opacity .28s ease, transform .28s ease';
                                return wrapper;
                            }

                            showBtn.addEventListener('click', function(){
                                if (remaining <= 0) return;
                                const toShow = Math.min(batch, remaining);
                                const startIndex = (<?php echo count($comments); ?>) + (<?php echo ($comment_count - count($comments)); ?> - remaining) + 1;
                                //append comments
                                for (let i = 0; i < toShow; i++) {
                                    const idx = startIndex + i;
                                    const el = createComment(idx);
                                    commentsList.appendChild(el);
                                    //force reflow then reveal with stagger
                                    (function(node, delay){
                                        setTimeout(()=>{
                                            node.style.opacity = '1';
                                            node.style.transform = 'translateY(0)';
                                        }, delay);
                                    })(el, i * 80);
                                }
                                remaining -= toShow;
                                showBtn.dataset.remaining = String(remaining);
                                if (remaining > 0) {
                                    showBtn.textContent = `Show ${remaining} More Comments`;
                                } else {
                                    showBtn.style.display = 'none';
                                }
                            });
                        }

                        // Reply form handling (client-side only)
                        function createReplyForm() {
                            const container = document.createElement('div');
                            container.className = 'mt-3';
                            container.innerHTML = `
                                <textarea class="reply-textarea w-full border rounded p-2 text-sm resize-none" rows="3" placeholder="Write a reply..."></textarea>
                                <div class="mt-2 flex items-center gap-2">
                                    <button type="button" class="reply-submit bg-blue-600 text-white px-3 py-1 rounded">Reply</button>
                                    <button type="button" class="reply-cancel bg-gray-200 px-3 py-1 rounded">Cancel</button>
                                </div>`;
                            return container;
                        }

                        // helper to open a reply form for a given .reply-link element
                        function openReplyFor(link) {
                            if (!link) return;
                            const commentWrapper = link.closest('.border-t');
                            if (!commentWrapper) return;
                            if (commentWrapper.querySelector('.reply-textarea')) return; // already open
                            const form = createReplyForm();
                            const contentArea = commentWrapper.querySelector('.flex-1') || commentWrapper;
                            contentArea.appendChild(form);
                            const textarea = form.querySelector('.reply-textarea');
                            textarea.focus();
                            // no live preview — per request we hide the form on submit and then show the reply
                            form.querySelector('.reply-cancel').addEventListener('click', function(){ form.remove(); });

                            function submitReply(){
                                const text = textarea.value.trim();
                                if (!text) return;
                                const replyEl = document.createElement('div');
                                replyEl.className = 'mt-3 reply-new reply-animate';
                                const nowLabel = 'just now';
                                const initials = 'Y';
                                replyEl.innerHTML = `
                                    <div class="flex gap-3">
                                        <div class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-semibold">${initials}</div>
                                        <div class="flex-1">
                                            <div class="text-sm font-semibold">You <span class="text-xs text-gray-500">• ${nowLabel}</span></div>
                                            <div class="mt-1 text-gray-800">${escapeHtml(text)}</div>
                                        </div>
                                    </div>`;
                                contentArea.appendChild(replyEl);
                                requestAnimationFrame(()=>{ replyEl.classList.remove('reply-animate'); replyEl.classList.add('reply-enter'); });
                                setTimeout(()=>{ replyEl.classList.remove('reply-new','reply-enter'); }, 3200);
                                form.remove();
                            }

                            form.querySelector('.reply-submit').addEventListener('click', submitReply);
                            textarea.addEventListener('keydown', function(ev){ if (ev.key === 'Enter' && !ev.shiftKey) { ev.preventDefault(); submitReply(); } });
                        }

                        // Delegate clicks for Reply links (robust: handle text-node targets)
                        commentsEl.addEventListener('click', function(e){
                            // find nearest ancestor element that is a reply-link
                            let link = null;
                            if (e.target && e.target.closest) {
                                link = e.target.closest('.reply-link');
                            } else {
                                // fallback for text nodes: walk up
                                let node = e.target;
                                while (node && node !== commentsEl) {
                                    if (node.nodeType === 1 && node.classList && node.classList.contains('reply-link')) { link = node; break; }
                                    node = node.parentNode;
                                }
                            }
                            if (!link) return;
                            e.preventDefault();
                            openReplyFor(link);
                        });

                        // Attach direct listeners to any existing .reply-link buttons (helps if delegation missed them)
                        document.querySelectorAll('#comments-section .reply-link').forEach(function(btn){
                            btn.addEventListener('click', function(ev){ ev.preventDefault(); openReplyFor(btn); });
                        });

                        // Delegated fallback for reply-submit buttons (handles cases where per-form listener didn't attach)
                        commentsEl.addEventListener('click', function(e){
                            const submitBtn = e.target.closest && e.target.closest('.reply-submit');
                            if (!submitBtn) return;
                            e.preventDefault();
                            const form = submitBtn.closest('.mt-3');
                            if (!form) return;
                            const textarea = form.querySelector('.reply-textarea');
                            if (!textarea) return;
                            const text = textarea.value.trim();
                            if (!text) return;
                            // find parent comment container
                            const commentWrapper = submitBtn.closest('.border-t');
                            const contentArea = (commentWrapper && (commentWrapper.querySelector('.flex-1') || commentWrapper)) || form.parentNode;
                            const replyEl = document.createElement('div');
                            replyEl.className = 'mt-3 reply-new reply-animate';
                            const nowLabel = 'just now';
                            const initials = 'Y';
                            replyEl.innerHTML = `
                                <div class="flex gap-3">
                                    <div class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-semibold">${initials}</div>
                                    <div class="flex-1">
                                        <div class="text-sm font-semibold">You <span class="text-xs text-gray-500">• ${nowLabel}</span></div>
                                        <div class="mt-1 text-gray-800">${escapeHtml(text)}</div>
                                    </div>
                                </div>`;
                            contentArea.appendChild(replyEl);
                            requestAnimationFrame(()=>{ replyEl.classList.remove('reply-animate'); replyEl.classList.add('reply-enter'); });
                            setTimeout(()=>{ replyEl.classList.remove('reply-new','reply-enter'); }, 3200);
                            form.remove();
                        });
                    });
                })();
                </script>
            </main>

            <!-- Right ad column -->
            <aside class="hidden md:block md:col-span-3">
                <div class="sticky top-24">
                    <div class="text-xs text-gray-500 mb-2">ADVERTISEMENT</div>
                    <div class="bg-white p-2 rounded shadow flex justify-center">
                        <img src="/assets/ads.png" alt="Advertisement" class="w-36 h-auto object-contain" />
                    </div>
                </div>
            </aside>
        </div>
    </div>

<?php include __DIR__ . '/../../footer.php'; ?>
